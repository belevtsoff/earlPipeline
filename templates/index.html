<html>
  <head>
    <!--dependencies-->
    <script type="text/javascript" src="{{static_url('js/libs/jquery-1.10.2.js')}}"></script>
    <script type="text/javascript" src="{{static_url('js/libs/jquery-ui-1.10.4.js')}}"></script>
    <script type="text/javascript" src="{{static_url('js/libs/jquery.jsPlumb-1.5.5.js')}}"></script>
    <script type="text/javascript" src="{{static_url('js/libs/handlebars.js')}}"></script>
    <script type="text/javascript" src="{{static_url('js/libs/ember.js')}}"></script>
    <script type="text/javascript" src="{{static_url('js/libs/ember-data.js')}}"></script>
    <script type="text/javascript" src="{{static_url('js/libs/bootstrap.js')}}"></script>
    <script type="text/javascript" src="{{static_url('js/libs/bootstrap-dialog.js')}}"></script>

    <!-- application code-->
    <script type="text/javascript" src="{{static_url('js/app.js')}}"></script>
    <script type="text/javascript" src="{{static_url('js/models.js')}}"></script>
    <script type="text/javascript" src="{{static_url('js/views.js')}}"></script>
    <script type="text/javascript" src="{{static_url('js/controllers.js')}}"></script>
    <script type="text/javascript" src="{{static_url('js/adapters.js')}}"></script>
    <script type="text/javascript" src="{{static_url('js/draw_styles.js')}}"></script>

    <!--CSS-->
    <link rel="stylesheet" href="{{static_url('css/main.css')}}">
    <link rel="stylesheet" href="{{static_url('css/unit.css')}}">
    <link rel="stylesheet" href="{{static_url('css/bootstrap.css')}}">
    <link rel="stylesheet" href="{{static_url('css/bootstrap-theme.css')}}">
    <link rel="stylesheet" href="{{static_url('css/bootstrap-dialog.css')}}">
  </head>
  <body>
    <script type="text/x-handlebars">
        <div class="navbar navbar-default">
            <div class="navbar-header"> <a class="navbar-brand" href="#">earlPipeline</a>

            </div>
            <ul class="nav navbar-nav">
                <li><a href="#" class="">Dashboard</a>

                </li>
                <li class="active"><a href="#" class="">Pipeline Constructor</a>

                </li>
            </ul>
        </div>

        <div class="container-fluid">
            <div class="row-fluid">
                <div class="col-md-6">
                   {{!outlet units}}
                   {{!outlet pipelineControls}}
                </div>
                <div class="col-md-6">
                    <div class="pull-right">
                        <button class="btn btn-default">
                            <span class="glyphicon glyphicon-save"></span> 
                            Save
                        </button>
                        <button class="btn btn-danger" style="">
                            <span class="glyphicon glyphicon-remove"></span> 
                            Delete
                        </button>
                    </div>
                </div>
            </div>
            <div class="row-fluid">
                {{!outlet pipeline}}
            </div>
        </div>
    </script>

    <script type="text/x-handlebars" data-template-name="metaUnits">
        <div class="btn-group">
            <a class="btn btn-default dropdown-toggle" data-toggle="dropdown" href="#">
                <span class="glyphicon glyphicon-plus"></span> Add Unit <span class="caret"></span>
            </a>

            <ul class="dropdown-menu">
                {{!#each itemController="metaUnit"}}
                    <li><a style="cursor: pointer" {{!action "addToPipeline"}}>{{!id}}</a></li>
                {{!/each}}
            </ul>
        </div>
    </script>

    <script type="text/x-handlebars" data-template-name="pipeline">
        {{!! The main panel, containig interactive units}}
        <div class="col-md-9" id="pipeline-container">
            <div class="info-panel units-box" oncontextmenu="return false;">
                {{!#each node in controller.nodes itemController="unit"}}
                    {{!view App.Item}}
                {{!/each}}
                {{!loadConnections controller.edges.content}}
            </div>
        </div>

        {{!! Results panel}}
        <div class="col-md-3">
            <div class="info-panel result-box" id="result-box">
                {{!view App.OutputView}}
            </div>
        </div>
    </script>

    <script type="text/x-handlebars" data-template-name="pipeline-output">
        <h3>Status: 
            {{!#if isRunning}}
                <font color="green">running</font>
            {{!else}}
                {{!#if hasFailed}}
                    <font color="red">failed</font>
                {{!else}}
                    <font color="grey">stopped</font>
                {{!/if}}
            {{!/if}}
        </h3>
        <hr>
        <div style="white-space: pre-wrap;">{{!executionResult}}</div>
    </script>

    <script type="text/x-handlebars" data-template-name="single-unit">
        <div class='panel-heading'>
            {{!view.controller.id}}
        </div>
    </script>

    <script type="text/x-handlebars" data-template-name="pipelineControls">
        {{!#if isRunning}}
            <button class="btn btn-warning" {{!action "stop"}}>
                <span class="glyphicon glyphicon-stop"></span> 
                Stop
            </button>
        {{!else}}
            <button class="btn btn-primary" {{!action "run"}}>
                <span class="glyphicon glyphicon-play"></span> 
                Run
            </button>
        {{!/if}}
        <font size="4" class="ppl-name">{{!App.currentPipeline.id}}</font>
    </script>
  </body>
</html>
