<html>
  <head>
    <!--dependencies-->
    <script type="text/javascript" src="{{url_for('static', filename='js/libs/jquery-1.10.2.js')}}"></script>
    <script type="text/javascript" src="{{url_for('static', filename='js/libs/jquery-ui-1.10.4.js')}}"></script>
    <script type="text/javascript" src="{{url_for('static', filename='js/libs/jquery.jsPlumb-1.5.5.js')}}"></script>
    <script type="text/javascript" src="{{url_for('static', filename='js/libs/handlebars.js')}}"></script>
    <script type="text/javascript" src="{{url_for('static', filename='js/libs/ember.js')}}"></script>
    <script type="text/javascript" src="{{url_for('static', filename='js/libs/ember-data.js')}}"></script>
    <script type="text/javascript" src="{{url_for('static', filename='js/libs/bootstrap.js')}}"></script>
    <script type="text/javascript" src="{{url_for('static', filename='js/libs/bootstrap-dialog.js')}}"></script>

    <!-- application code-->
    <script type="text/javascript" src="{{url_for('static', filename='js/app.js')}}"></script>
    <script type="text/javascript" src="{{url_for('static', filename='js/models.js')}}"></script>
    <script type="text/javascript" src="{{url_for('static', filename='js/views.js')}}"></script>
    <script type="text/javascript" src="{{url_for('static', filename='js/controllers.js')}}"></script>
    <script type="text/javascript" src="{{url_for('static', filename='js/adapters.js')}}"></script>
    <script type="text/javascript" src="{{url_for('static', filename='js/draw_styles.js')}}"></script>

    <!--CSS-->
    <link rel="stylesheet" href="{{url_for('static', filename='css/main.css')}}">
    <link rel="stylesheet" href="{{url_for('static', filename='css/unit.css')}}">
    <link rel="stylesheet" href="{{url_for('static', filename='css/bootstrap.css')}}">
    <link rel="stylesheet" href="{{url_for('static', filename='css/bootstrap-theme.css')}}">
    <link rel="stylesheet" href="{{url_for('static', filename='css/bootstrap-dialog.css')}}">
  </head>
  <body>
  {% raw %}
  
    <script type="text/x-handlebars">
        <div class="navbar navbar-default">
            <div class="navbar-header"> <a class="navbar-brand" href="#">earlPipeline</a>

            </div>
            <ul class="nav navbar-nav">
                <li><a href="#" class="">Dashboard</a>

                </li>
                <li class="active"><a href="#" class="">Pipeline Constructor</a>

                </li>
            </ul>
        </div>

        <div class="container-fluid">
            <div class="row-fluid">
                <div class="col-md-6">
                   {{outlet units}}
                   {{outlet pipelineControls}}
                </div>
                <div class="col-md-6">
                    <div class="pull-right">
                        <button class="btn btn-default">
                            <span class="glyphicon glyphicon-save"></span> 
                            Save
                        </button>
                        <button class="btn btn-danger" style="">
                            <span class="glyphicon glyphicon-off"></span> 
                            Close
                        </button>
                    </div>
                </div>
            </div>
            <div class="row-fluid">
                {{outlet pipeline}}
            </div>
        </div>
    </script>

    <script type="text/x-handlebars" data-template-name="metaUnits">
        <div class="btn-group">
            <a class="btn btn-default dropdown-toggle" data-toggle="dropdown" href="#">
                <span class="glyphicon glyphicon-plus"></span> Add Unit <span class="caret"></span>
            </a>

            <ul class="dropdown-menu">
                {{#each itemController="metaUnit"}}
                    <li><a style="cursor: pointer" {{action "addToPipeline"}}>{{id}}</a></li>
                {{/each}}
            </ul>
        </div>
    </script>

    <script type="text/x-handlebars" data-template-name="pipeline">
        {{! The main panel, containig interactive units}}
        <div class="col-md-9" id="pipeline-container">
            <div class="info-panel units-box" oncontextmenu="return false;">
                {{#each node in controller.nodes itemController="unit"}}
                    {{view App.Item}}
                {{/each}}
                {{loadConnections controller.edges.content}}
            </div>
        </div>

        {{! Results panel}}
        <div class="col-md-3">
            <div class="info-panel result-box" id="result-box">
                {{view App.OutputView}}
            </div>
        </div>
    </script>

    <script type="text/x-handlebars" data-template-name="pipeline-output">
        <h3>Output:</h3>
        {{#if isRunning}}
            <img src="static/css/ajax-loader.gif">
        {{else}}
            {{#if executionResult}}
                <div style="white-space: pre-wrap;">{{executionResult}}</div>
            {{else}}
                No results yet. Hit "Execute" to run the pipeline
            {{/if}}
        {{/if}}
    </script>

    <script type="text/x-handlebars" data-template-name="single-unit">
        <div class='panel-heading'>
            {{view.controller.id}}
        </div>
    </script>

    <script type="text/x-handlebars" data-template-name="pipelineControls">
        <button class="btn btn-primary" {{bind-attr disabled=isRunning}} {{action "run"}}>
            {{#if isRunning}}
                <span class="glyphicon glyphicon-time"></span> 
            {{else}}
                <span class="glyphicon glyphicon-flash"></span> 
            {{/if}}
            Execute
        </button>
        <font size="4" class="ppl-name">{{App.currentPipeline.id}}</font>
    </script>

  {% endraw %}
  </body>
</html>
